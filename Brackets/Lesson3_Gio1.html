<html>
    <head>
        <script src='d3.v3.min.js'></script>
        
        <style>
            line,path{
                fill:none;
                stroke: black
            }
        
        </style>
        
        
    </head>

    <body>
        <svg></svg>
        
        <script>
        
            var ayg = d3.select('svg')
                .append('g')
                .attr('transform', 'translate(270, 10)')
            
            var axg = d3.select('svg')
                .append('g')
                .attr('transform', 'translate(0, 110)')
                //.attr('transform', 'rotate(45)')
                
            
            function draw(data){ 
            
            var circle = d3.select('svg')
                .selectAll('circle')
                .data(data)
                        
          
          var mapY = d3.scale.linear()
                .domain([40, 0])
                .range([0,100])
           
            
            var ay = d3.svg.axis()
                .orient('right')
                .scale(mapY)
                
            
            ayg.transition()
                .call(ay)
            
            var mapX = d3.scale.linear()
                .domain([0,data.length])
                .range([20, 270])
            // massimo raggio del cerchio = 20
            // dimensioni svg 0 --> 300

            //definisce l'asse, va richiamato
            // configuratore
            var ax = d3.svg.axis()
                .orient('bottom')
                .scale(mapX)
            
            axg.transition()
                .call(ax)
                        
            
            // enter block  
            circle.enter()
                .append('circle')
                .attr('cx', function(d, i){
                    // return (i  + 1) * 9
                    return mapX(i)
                })
            // con la x a 0, partono tutti da sinistra
            // senza cx, partono ognuno dal proprio centro
                .attr('cx', 0) 
                .attr('cy', 40)
                .attr('r',0)
                
    // per gestire i cerchi di cui non ho pi√π bisogno
    // exit block
            circle.exit()
                .transition()
                .duration(1000)
                .attr('r', 0)
                .remove()
            
     // update block       
            circle.transition()
                .duration(2000)
                .delay(function(d, i){
                    return i * 100
                })
                .attr('r', function(d, i){
                    return d * 10                    
                })
                .attr('cx', function(d, i){
                    // return (i  + 1) * 9
                    return mapX(i)
                })
            
            }
            
            
            d3.select('svg')
                .on('click',function(){
        // Generatore di numeri randomici tra 0 e 1
        // Ogni volta che clicco, rigenera il data set
        // ad ogni click
                var l = parseInt(Math.random()*20) + 3
                console.log(l)
                
                var data = d3.range(l).map(function(){
                        return Math.random()
                         })           
                draw(data)
                })
            
            
            
            
            
            
        </script>
    </body>
</html>